<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>RTP Streams - Unofficial AirPlay Specification</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="../css/table.css">
        
        <link rel="stylesheet" href="../css/examples.css">
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div id="sidebar-scrollbox" class="sidebar-scrollbox">
                <div id="examples-select"></div>
                <ol class="chapter"><li class="expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="expanded "><a href="../service_discovery.html"><strong aria-hidden="true">2.</strong> Service Discovery</a></li><li class="expanded "><a href="../features.html"><strong aria-hidden="true">3.</strong> Features</a></li><li class="expanded "><a href="../status_flags.html"><strong aria-hidden="true">4.</strong> Status Flags</a></li><li class="expanded "><a href="../photos/index.html"><strong aria-hidden="true">5.</strong> Photos</a></li><li><ol class="section"><li class="expanded "><a href="../photos/http_requests.html"><strong aria-hidden="true">5.1.</strong> HTTP Requests</a></li><li class="expanded "><a href="../photos/events.html"><strong aria-hidden="true">5.2.</strong> Events</a></li><li class="expanded "><a href="../photos/photo_caching.html"><strong aria-hidden="true">5.3.</strong> Photo Caching</a></li><li class="expanded "><a href="../photos/slideshows.html"><strong aria-hidden="true">5.4.</strong> Slideshows</a></li></ol></li><li class="expanded "><a href="../video/index.html"><strong aria-hidden="true">6.</strong> Video</a></li><li><ol class="section"><li class="expanded "><a href="../video/http_requests.html"><strong aria-hidden="true">6.1.</strong> HTTP Requests</a></li><li class="expanded "><a href="../video/events.html"><strong aria-hidden="true">6.2.</strong> Events</a></li></ol></li><li class="expanded "><a href="../audio/index.html"><strong aria-hidden="true">7.</strong> Audio</a></li><li><ol class="section"><li class="expanded "><a href="../audio/rtsp_requests/index.html"><strong aria-hidden="true">7.1.</strong> RTSP Requests</a></li><li><ol class="section"><li class="expanded "><a href="../audio/rtsp_requests/get_info.html"><strong aria-hidden="true">7.1.1.</strong> GET /info</a></li><li class="expanded "><a href="../audio/rtsp_requests/post_pair_setup.html"><strong aria-hidden="true">7.1.2.</strong> POST /pair-setup</a></li><li class="expanded "><a href="../audio/rtsp_requests/post_pair_verify.html"><strong aria-hidden="true">7.1.3.</strong> POST /pair-verify</a></li><li class="expanded "><a href="../audio/rtsp_requests/post_fp_setup.html"><strong aria-hidden="true">7.1.4.</strong> POST /fp-setup</a></li><li class="expanded "><a href="../audio/rtsp_requests/post_auth_setup.html"><strong aria-hidden="true">7.1.5.</strong> POST /auth-setup</a></li><li class="expanded "><a href="../audio/rtsp_requests/options.html"><strong aria-hidden="true">7.1.6.</strong> OPTIONS</a></li><li class="expanded "><a href="../audio/rtsp_requests/announce.html"><strong aria-hidden="true">7.1.7.</strong> ANNOUNCE</a></li><li class="expanded "><a href="../audio/rtsp_requests/setup.html"><strong aria-hidden="true">7.1.8.</strong> SETUP</a></li><li class="expanded "><a href="../audio/rtsp_requests/setpeers.html"><strong aria-hidden="true">7.1.9.</strong> SETPEERS</a></li><li class="expanded "><a href="../audio/rtsp_requests/post_command.html"><strong aria-hidden="true">7.1.10.</strong> POST /command</a></li><li class="expanded "><a href="../audio/rtsp_requests/post_feedback.html"><strong aria-hidden="true">7.1.11.</strong> POST /feedback</a></li><li class="expanded "><a href="../audio/rtsp_requests/post_audio_mode.html"><strong aria-hidden="true">7.1.12.</strong> POST /audioMode</a></li><li class="expanded "><a href="../audio/rtsp_requests/record.html"><strong aria-hidden="true">7.1.13.</strong> RECORD</a></li><li class="expanded "><a href="../audio/rtsp_requests/flush.html"><strong aria-hidden="true">7.1.14.</strong> FLUSH</a></li><li class="expanded "><a href="../audio/rtsp_requests/flushbuffered.html"><strong aria-hidden="true">7.1.15.</strong> FLUSHBUFFERED</a></li><li class="expanded "><a href="../audio/rtsp_requests/teardown.html"><strong aria-hidden="true">7.1.16.</strong> TEARDOWN</a></li></ol></li><li class="expanded "><a href="../audio/rtp_streams.html" class="active"><strong aria-hidden="true">7.2.</strong> RTP Streams</a></li><li class="expanded "><a href="../audio/volume_control.html"><strong aria-hidden="true">7.3.</strong> Volume Control</a></li><li class="expanded "><a href="../audio/metadata.html"><strong aria-hidden="true">7.4.</strong> Metadata</a></li><li class="expanded "><a href="../audio/airport_express_authentication.html"><strong aria-hidden="true">7.5.</strong> AirPort Express Authentication</a></li><li class="expanded "><a href="../audio/remote_control.html"><strong aria-hidden="true">7.6.</strong> Remote Control</a></li></ol></li><li class="expanded "><a href="../screen_mirroring/index.html"><strong aria-hidden="true">8.</strong> Screen Mirroring</a></li><li><ol class="section"><li class="expanded "><a href="../screen_mirroring/http_requests.html"><strong aria-hidden="true">8.1.</strong> HTTP Requests</a></li><li class="expanded "><a href="../screen_mirroring/stream_packets.html"><strong aria-hidden="true">8.2.</strong> Stream Packets</a></li><li class="expanded "><a href="../screen_mirroring/time_synchronization.html"><strong aria-hidden="true">8.3.</strong> Time Synchronization</a></li></ol></li><li class="expanded "><a href="../pairing/index.html"><strong aria-hidden="true">9.</strong> Pairing</a></li><li><ol class="section"><li class="expanded "><a href="../pairing/hkp.html"><strong aria-hidden="true">9.1.</strong> HomeKit Based Pairings</a></li><li class="expanded "><a href="../pairing/legacy.html"><strong aria-hidden="true">9.2.</strong> Legacy Pairing</a></li></ol></li><li class="expanded "><a href="../known_implementations.html"><strong aria-hidden="true">10.</strong> Known Implementations</a></li><li class="expanded "><a href="../contributing.html"><strong aria-hidden="true">11.</strong> Contributing</a></li><li class="expanded "><a href="../history.html"><strong aria-hidden="true">12.</strong> History</a></li><li class="expanded "><a href="../resources.html"><strong aria-hidden="true">13.</strong> Resources</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Unofficial AirPlay Specification</h1>

                        <div class="right-buttons">
                            <a href="../print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#rtp-streams" id="rtp-streams">RTP Streams</a></h1>
<p>Audio packets are fully RTP compliant. Control and timing packets,
however, do not seem to be fully compliant with the RTP standard.</p>
<p>The following payload types are defined:</p>
<table><thead><tr><th>payload type</th><th>port</th><th>description</th></tr></thead><tbody>
<tr><td>82</td><td>timing_port</td><td>timing request</td></tr>
<tr><td>83</td><td>timing_port</td><td>timing reply</td></tr>
<tr><td>84</td><td>control_port</td><td>time sync</td></tr>
<tr><td>85</td><td>control_port</td><td>retransmit request</td></tr>
<tr><td>86</td><td>control_port</td><td>retransmit reply</td></tr>
<tr><td>96</td><td>server_port</td><td>audio data</td></tr>
</tbody></table>
<h2><a class="header" href="#audio-packets" id="audio-packets">Audio packets</a></h2>
<p>Audio data is sent using the <code>DynamicRTP-Type-96</code> payload type. The <code>Marker</code>
bit is set on the first packet sent after <code>RECORD</code> or <code>FLUSH</code> requests. The RTP
payload contains optionally encrypted audio data.</p>
<p><span class="ex">Example:</span> encrypted audio packet</p>
<div class="client_server">
<p>client &rarr; server</p>
<pre><code class="language-hex">0000   80 e0 b1 91 f7 79 16 c2 e8 bb 6b 2c bb 5c 8e 51
0010   aa 7c d2 96 00 c3 fd 60 eb ae 6e 41 31 38 fe ae
....
03e0   cb 1c 73 bf e7 05 93 30 fa 85 7f 32 77 8d a8 97
03f0   a0 c7 c8 78 7b e5 81 a1 4f b4 3e a3 43 db 7c

Real-Time Transport Protocol
10.. .... = Version: RFC 1889 Version (2)
..0. .... = Padding: False
...0 .... = Extension: False
.... 0000 = Contributing source identifiers count: 0
1... .... = Marker: True
Payload type: DynamicRTP-Type-96 (96)
Sequence number: 45457
Timestamp: 4151908034
Synchronization Source identifier: 0xe8bb6b2c (3904596780)
Payload: bb5c8e51aa7cd29600c3fd60ebae6e413138feae909b44f1...
</code></pre>
</div>
<h2><a class="header" href="#sync-packets" id="sync-packets">Sync packets</a></h2>
<p>Sync packets are sent once per second to the control port. They are used to
correlate the RTP timestamps currently used in the audio stream to the NTP time
used for clock synchronization. Payload type is 84, the <code>Marker</code> bit is always
set and the <code>Extension</code> bit is set on the first packet after <code>RECORD</code> or
<code>FLUSH</code> requests. The <code>SSRC</code> field is not included in the RTP header.</p>
<table><thead><tr><th>bytes</th><th>description</th></tr></thead><tbody>
<tr><td>8</td><td>RTP header without <code>SSRC</code></td></tr>
<tr><td>8</td><td>current NTP time</td></tr>
<tr><td>4</td><td>RTP timestamp for the next audio packet</td></tr>
</tbody></table>
<p><span class="ex">Example:</span> sync packet</p>
<div class="client_server">
<p>client &rarr; server</p>
<pre><code class="language-hex">0000   80 d4 00 04 c7 cd 11 a8 83 ab 1c 49 2f e4 22 e2
0010   c7 ce 3f 1f

Real-Time Transport Protocol
10.. .... = Version: RFC 1889 Version (2)
..0. .... = Padding: False
...0 .... = Extension: False
.... 0000 = Contributing source identifiers count: 0
1... .... = Marker: True
Payload type: Unassigned (84)
Sequence number: 4
Timestamp: 3352105384
Synchronization Source identifier: 0x83ab1c49 (2209029193)
Payload: 2fe422e2c7ce3f1f
</code></pre>
</div>
<h2><a class="header" href="#retransmit-packets" id="retransmit-packets">Retransmit packets</a></h2>
<p>AirTunes supports resending audio packets which have been lost. Payload
type is 85 for retransmit queries, the <code>Marker</code> bit is always set and the
<code>SSRC</code> field is not included in the RTP header.</p>
<table><thead><tr><th>bytes</th><th>description</th></tr></thead><tbody>
<tr><td>8</td><td>RTP header without <code>SSRC</code></td></tr>
<tr><td>2</td><td>sequence number for the first lost packet</td></tr>
<tr><td>2</td><td>number of lost packets</td></tr>
</tbody></table>
<p>Retransmit replies have payload type 86, with a full audio RTP packet
after the sequence number.</p>
<h2><a class="header" href="#timing-packets" id="timing-packets">Timing packets</a></h2>
<p>Timing packets are used to synchronize a master clock for audio. This is
useful for clock recovery and precise synchronization of several devices
playing the same audio stream.</p>
<p>Timing packets are sent at 3 second intervals. They always have the
<code>Marker</code> bit set, and payload type 82 for queries and 83 for replies.
The <code>SSRC</code> field is not included in the RTP header, so it takes only 8
bytes, followed by three <em>NTP</em> timestamps:</p>
<table><thead><tr><th>bytes</th><th>description</th></tr></thead><tbody>
<tr><td>8</td><td>RTP header without <code>SSRC</code></td></tr>
<tr><td>8</td><td>origin timestamp</td></tr>
<tr><td>8</td><td>receive timestamp</td></tr>
<tr><td>8</td><td>transmit timestamp</td></tr>
</tbody></table>
<p><span class="ex">Example:</span> timing query/reply</p>
<div class="server_client">
<p>server &rarr; client</p>
<pre><code class="language-hex">0000   80 d2 00 07 00 00 00 00 00 00 00 00 00 00 00 00
0010   00 00 00 00 00 00 00 00 83 c1 17 cc af ba 9b 32

Real-Time Transport Protocol
10.. .... = Version: RFC 1889 Version (2)
..0. .... = Padding: False
...0 .... = Extension: False
.... 0000 = Contributing source identifiers count: 0
1... .... = Marker: True
Payload type: Unassigned (82)
Sequence number: 7
Timestamp: 0
Synchronization Source identifier: 0x00000000 (0)
Payload: 00000000000000000000000083c117ccafba9b32
</code></pre>
</div>
<div class="client_server">
<p>client &rarr; server</p>
<pre><code class="language-hex">0000   80 d3 00 07 00 00 00 00 83 c1 17 cc af ba 9b 32
0010   83 c1 17 cc b0 12 ce b6 83 c1 17 cc b0 14 10 47

Real-Time Transport Protocol
10.. .... = Version: RFC 1889 Version (2)
..0. .... = Padding: False
...0 .... = Extension: False
.... 0000 = Contributing source identifiers count: 0
1... .... = Marker: True
Payload type: Unassigned (83)
Sequence number: 7
Timestamp: 0
Synchronization Source identifier: 0x83c117cc (2210469836)
Payload: afba9b3283c117ccb012ceb683c117ccb0141047
</code></pre>
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../audio/rtsp_requests/teardown.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../audio/volume_control.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="../audio/rtsp_requests/teardown.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="../audio/volume_control.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        
        <script type="text/javascript" src="../js/app.js" charset="utf-8"></script>
        

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
